# Introduction #

In this wiki page, the test environment will be presented together with the logical steps necessary to test the SNEP (Simple NDEF Push Protocol) library. In particular this wiki shows the updated code useful to be used  with the Samsung S3 and other Android devices with OS version 4.2.
The solution I've found (and implemented) it's the usage of a Target approach both to send data to the smartphone and to receive data from the smartphone.


# Details #

## Test Environment ##

![http://ismb-snep-java.googlecode.com/files/TestEnvironment-2013.png](http://ismb-snep-java.googlecode.com/files/TestEnvironment-2013.png)


---


## PC Side - General Requirements ##

- Java and an IDE (e.g. Eclipse)


- ACS ACR122U PC/SC Driver, available at

http://www.acs.com.hk/index.php?pid=product&id=ACR122U


- if you're using Eclipse, modify settings in order to use javax.smartcard
as shown in the page

http://code.google.com/p/ismb-npp-java/wiki/EclipseSettings4javax


-Download the library source code available in the download section

source: http://ismb-snep-java.googlecode.com/files/ISMB-SNEP-Library.zip

<br />


## Android side - Requirements to receive data (flow: Smartphone -> PC) ##

if you need to receive data from a Smartphone on your PC, you should download and install the Android app available in the download section.

source: http://ismb-snep-java.googlecode.com/files/SNEP_PhoneToReader_Android_Client_SRC.zip

or

installer: http://ismb-snep-java.googlecode.com/files/SNEP_PhoneToReader_Android_Client_APK.zip



<br />


## Android side - Requirements to send data (flow: PC -> Smartphone) ##

if you need to send data from your PC to a smartphone, you should download and install the Android app available in the download section.


- Download and install the Android app available in the download section.

source: http://ismb-snep-java.googlecode.com/files/SnepReaderToPhoneSource.zip

or

installer: http://ismb-snep-java.googlecode.com/files/SnepReaderToPhone.apk.zip

---


## Steps to receive data ##

### 1) Execute the 'SnepPusher' app installed on the Android device ###

... then wait until you'll see the following message:

![http://ismb-snep-java.googlecode.com/files/Android_Starting_SenderApp.jpg](http://ismb-snep-java.googlecode.com/files/Android_Starting_SenderApp.jpg)

### 2) Execute the java code "NFCReader", contained in the archive ###
http://ismb-snep-java.googlecode.com/files/ISMB-SNEP-Library.zip

... then wait until the following messages appear in the console:

```
Get factory
Get terminals
Terminal name: ACS ACR122U 00 00
Available Commands: receive, send and quit
```

### 3) Write "receive" and wait unit the following messages appear in the console ###

```
Get factory
Get terminals
Terminal name: ACS ACR122U 00 00
Available Commands: receive, send and quit
receive
card: PC/SC card in ACS ACR122U 00 00, protocol T=0, state OK
Protocol:T=0
Called new Procedure to receive data .. TARGET MODE
[DEBUG] {sending   [56 bytes]} 0xFF 0x00 0x00 0x00 0x33 0xD4 0x8C 0x02 0x00 0x00 0x00 0x00 0x00 0x40 0x01 0xFE 0x0F 0xBB 0xBA 0xA6 0xC9 0x89 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0xFF 0xFF 0x01 0xFE 0x0F 0xBB 0xBA 0xA6 0xC9 0x89 0x00 0x00 0x0F 0x46 0x66 0x6D 0x01 0x01 0x10 0x03 0x02 0x00 0x01 0x04 0x01 0x96 
```

### 4) Put the Android phone on NFC reader ###

![http://ismb-snep-java.googlecode.com/files/Putting_Smartphone_On_site.jpg](http://ismb-snep-java.googlecode.com/files/Putting_Smartphone_On_site.jpg)


### 5) As soon as the phone will be on the NFC reader, the J2SE application will go on printing always the same exchange ###
```
Get factory
Get terminals
Terminal name: ACS ACR122U 00 00
Available Commands: receive, send and quit
receive
card: PC/SC card in ACS ACR122U 00 00, protocol T=0, state OK
Protocol:T=0
Called new Procedure to receive data .. TARGET MODE
[DEBUG] {sending   [56 bytes]} 0xFF 0x00 0x00 0x00 0x33 0xD4 0x8C 0x02 0x00 0x00 0x00 0x00 0x00 0x40 0x01 0xFE 0x0F 0xBB 0xBA 0xA6 0xC9 0x89 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0xFF 0xFF 0x01 0xFE 0x0F 0xBB 0xBA 0xA6 0xC9 0x89 0x00 0x00 0x0F 0x46 0x66 0x6D 0x01 0x01 0x10 0x03 0x02 0x00 0x01 0x04 0x01 0x96 
[DEBUG] {receiving [35 bytes]} 0xD5 0x8D 0x25 0x1E 0xD4 0x00 0xEA 0x77 0x26 0x59 0xE9 0xA8 0xED 0x3B 0x3A 0x64 0x00 0x00 0x00 0x32 0x46 0x66 0x6D 0x01 0x01 0x11 0x03 0x02 0x00 0x13 0x04 0x01 0x96 0x90 0x00 
[...]
[DEBUG] {sending   [7 bytes]} 0xFF 0x00 0x00 0x00 0x02 0xD4 0x86 
[DEBUG] {receiving [7 bytes]} 0xD5 0x87 0x00 0x00 0x00 0x90 0x00 
[DEBUG] {sending   [9 bytes]} 0xFF 0x00 0x00 0x00 0x04 0xD4 0x8E 0x00 0x00 
[DEBUG] {receiving [5 bytes]} 0xD5 0x8F 0x00 0x90 0x00 
[...]
[DEBUG] {sending   [7 bytes]} 0xFF 0x00 0x00 0x00 0x02 0xD4 0x86 
[DEBUG] {receiving [7 bytes]} 0xD5 0x87 0x00 0x00 0x00 0x90 0x00 
[DEBUG] {sending   [9 bytes]} 0xFF 0x00 0x00 0x00 0x04 0xD4 0x8E 0x00 0x00 
[DEBUG] {receiving [5 bytes]} 0xD5 0x8F 0x00 0x90 0x00 
[DEBUG] {sending   [7 bytes]} 0xFF 0x00 0x00 0x00 0x02 0xD4 0x86 
[DEBUG] {receiving [7 bytes]} 0xD5 0x87 0x00 0x00 0x00 0x90 0x00 
[DEBUG] {sending   [9 bytes]} 0xFF 0x00 0x00 0x00 0x04 0xD4 0x8E 0x00 0x00 
[DEBUG] {receiving [5 bytes]} 0xD5 0x8F 0x00 0x90 0x00 
[DEBUG] {sending   [7 bytes]} 0xFF 0x00 0x00 0x00 0x02 0xD4 0x86 
[DEBUG] {receiving [7 bytes]} 0xD5 0x87 0x00 0x00 0x00 0x90 0x00 
[DEBUG] {sending   [9 bytes]} 0xFF 0x00 0x00 0x00 0x04 0xD4 0x8E 0x00 0x00 
[DEBUG] {receiving [5 bytes]} 0xD5 0x8F 0x00 0x90 0x00 
[DEBUG] {sending   [7 bytes]} 0xFF 0x00 0x00 0x00 0x02 0xD4 0x86 
[DEBUG] {receiving [7 bytes]} 0xD5 0x87 0x00 0x00 0x00 0x90 0x00 
[DEBUG] {sending   [9 bytes]} 0xFF 0x00 0x00 0x00 0x04 0xD4 0x8E 0x00 0x00 
[DEBUG] {receiving [5 bytes]} 0xD5 0x8F 0x00 0x90 0x00 
```


### 6) This exchange will continue until you'll touch the smartphone, enabling the push operation. ###

![http://ismb-snep-java.googlecode.com/files/AndroidPushToSend.jpg](http://ismb-snep-java.googlecode.com/files/AndroidPushToSend.jpg)

### 7) When you'll touch the display, the message will be sent and, at the end, an acknowledge will be shown on the smartphone ###

![http://ismb-snep-java.googlecode.com/files/Android_Ack_Message_Sent.jpg](http://ismb-snep-java.googlecode.com/files/Android_Ack_Message_Sent.jpg)


On the library side (PC), instead, the NFC reader will receive data and, consequently, the output will change and you'll have the data received logged both in hex and in ASCII string (Both NDEF TYPE and PAYLOAD)

```
Get factory
Get terminals
Terminal name: ACS ACR122U 00 00
Available Commands: receive, send and quit
receive
card: PC/SC card in ACS ACR122U 00 00, protocol T=0, state OK
Protocol:T=0
Called new Procedure to receive data .. TARGET MODE
[DEBUG] {sending   [56 bytes]} 0xFF 0x00 0x00 0x00 0x33 0xD4 0x8C 0x02 0x00 0x00 0x00 0x00 0x00 0x40 0x01 0xFE 0x0F 0xBB 0xBA 0xA6 0xC9 0x89 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0xFF 0xFF 0x01 0xFE 0x0F 0xBB 0xBA 0xA6 0xC9 0x89 0x00 0x00 0x0F 0x46 0x66 0x6D 0x01 0x01 0x10 0x03 0x02 0x00 0x01 0x04 0x01 0x96 
[DEBUG] {receiving [35 bytes]} 0xD5 0x8D 0x25 0x1E 0xD4 0x00 0xEA 0x77 0x26 0x59 0xE9 0xA8 0xED 0x3B 0x3A 0x64 0x00 0x00 0x00 0x32 0x46 0x66 0x6D 0x01 0x01 0x11 0x03 0x02 0x00 0x13 0x04 0x01 0x96 0x90 0x00 
[DEBUG] {sending   [7 bytes]} 0xFF 0x00 0x00 0x00 0x02 0xD4 0x86 
[DEBUG] {receiving [7 bytes]} 0xD5 0x87 0x00 0x00 0x00 0x90 0x00 
[DEBUG] {sending   [9 bytes]} 0xFF 0x00 0x00 0x00 0x04 0xD4 0x8E 0x00 0x00 
[DEBUG] {receiving [5 bytes]} 0xD5 0x8F 0x00 0x90 0x00 
[DEBUG] {sending   [7 bytes]} 0xFF 0x00 0x00 0x00 0x02 0xD4 0x86 
[DEBUG] {receiving [7 bytes]} 0xD5 0x87 0x00 0x00 0x00 0x90 0x00 
[DEBUG] {sending   [9 bytes]} 0xFF 0x00 0x00 0x00 0x04 0xD4 0x8E 0x00 0x00 
[DEBUG] {receiving [5 bytes]} 0xD5 0x8F 0x00 0x90 0x00 
[DEBUG] {sending   [7 bytes]} 0xFF 0x00 0x00 0x00 0x02 0xD4 0x86 
[DEBUG] {receiving [7 bytes]} 0xD5 0x87 0x00 0x00 0x00 0x90 0x00 
[DEBUG] {sending   [9 bytes]} 0xFF 0x00 0x00 0x00 0x04 0xD4 0x8E 0x00 0x00 
[DEBUG] {receiving [5 bytes]} 0xD5 0x8F 0x00 0x90 0x00 
[DEBUG] {sending   [7 bytes]} 0xFF 0x00 0x00 0x00 0x02 0xD4 0x86 
[DEBUG] {receiving [7 bytes]} 0xD5 0x87 0x00 0x00 0x00 0x90 0x00 
[DEBUG] {sending   [9 bytes]} 0xFF 0x00 0x00 0x00 0x04 0xD4 0x8E 0x00 0x00 
[DEBUG] {receiving [5 bytes]} 0xD5 0x8F 0x00 0x90 0x00 
[DEBUG] {sending   [7 bytes]} 0xFF 0x00 0x00 0x00 0x02 0xD4 0x86 
[DEBUG] {receiving [7 bytes]} 0xD5 0x87 0x00 0x11 0x20 0x90 0x00 
[DEBUG] {sending   [9 bytes]} 0xFF 0x00 0x00 0x00 0x04 0xD4 0x8E 0x81 0x84 
[DEBUG] {receiving [5 bytes]} 0xD5 0x8F 0x00 0x90 0x00 
[DEBUG] {sending   [9 bytes]} 0xFF 0x00 0x00 0x00 0x04 0xD4 0x8E 0x00 0x00 
[DEBUG] {receiving [5 bytes]} 0xD5 0x8F 0x00 0x90 0x00 
[DEBUG] {sending   [7 bytes]} 0xFF 0x00 0x00 0x00 0x02 0xD4 0x86 
[DEBUG] {receiving [85 bytes]} 0xD5 0x87 0x00 0x13 0x20 0x00 0x10 0x02 0x00 0x00 0x00 0x47 0xD2 0x24 0x20 0x61 0x70 0x70 0x6C 0x69 0x63 0x61 0x74 0x69 0x6F 0x6E 0x2F 0x63 0x6F 0x6D 0x2E 0x65 0x78 0x61 0x6D 0x70 0x6C 0x65 0x2E 0x61 0x6E 0x64 0x72 0x6F 0x69 0x64 0x2E 0x62 0x65 0x61 0x6D 0x42 0x65 0x61 0x6D 0x20 0x6D 0x65 0x20 0x75 0x70 0x21 0x0A 0x0A 0x42 0x65 0x61 0x6D 0x20 0x54 0x69 0x6D 0x65 0x3A 0x20 0x31 0x34 0x3A 0x33 0x33 0x3A 0x30 0x31 0x90 0x00 
Something received: 
 GÃ’$ application/com.example.android.beamBeam me up!

Beam Time: 14:33:01
[DEBUG] {sending   [10 bytes]} 0xFF 0x00 0x00 0x00 0x05 0xD4 0x8E 0x83 0x44 0x01 
[DEBUG] {receiving [5 bytes]} 0xD5 0x8F 0x00 0x90 0x00 
[DEBUG] {sending   [7 bytes]} 0xFF 0x00 0x00 0x00 0x02 0xD4 0x86 
[DEBUG] {receiving [7 bytes]} 0xD5 0x87 0x00 0x00 0x00 0x90 0x00 
[DEBUG] {sending   [16 bytes]} 0xFF 0x00 0x00 0x00 0x0B 0xD4 0x8E 0x83 0x04 0x01 0x10 0x81 0x00 0x00 0x00 0x00 
[DEBUG] {receiving [5 bytes]} 0xD5 0x8F 0x00 0x90 0x00 
[DEBUG] {sending   [7 bytes]} 0xFF 0x00 0x00 0x00 0x02 0xD4 0x86 
[DEBUG] {receiving [8 bytes]} 0xD5 0x87 0x00 0x13 0x60 0x01 0x90 0x00 
[DEBUG] {sending   [9 bytes]} 0xFF 0x00 0x00 0x00 0x04 0xD4 0x8E 0x00 0x00 
[DEBUG] {receiving [5 bytes]} 0xD5 0x8F 0x00 0x90 0x00 
[DEBUG] {sending   [7 bytes]} 0xFF 0x00 0x00 0x00 0x02 0xD4 0x86 
[DEBUG] {receiving [84 bytes]} 0xD5 0x87 0x00 0x11 0x60 0x10 0x02 0x00 0x00 0x00 0x47 0xD2 0x24 0x20 0x61 0x70 0x70 0x6C 0x69 0x63 0x61 0x74 0x69 0x6F 0x6E 0x2F 0x63 0x6F 0x6D 0x2E 0x65 0x78 0x61 0x6D 0x70 0x6C 0x65 0x2E 0x61 0x6E 0x64 0x72 0x6F 0x69 0x64 0x2E 0x62 0x65 0x61 0x6D 0x42 0x65 0x61 0x6D 0x20 0x6D 0x65 0x20 0x75 0x70 0x21 0x0A 0x0A 0x42 0x65 0x61 0x6D 0x20 0x54 0x69 0x6D 0x65 0x3A 0x20 0x31 0x34 0x3A 0x33 0x33 0x3A 0x30 0x31 0x90 0x00 
[DEBUG] {sending   [10 bytes]} 0xFF 0x00 0x00 0x00 0x05 0xD4 0x8E 0x81 0xC4 0x00 
[DEBUG] {receiving [5 bytes]} 0xD5 0x8F 0x00 0x90 0x00 
[DEBUG] {sending   [7 bytes]} 0xFF 0x00 0x00 0x00 0x02 0xD4 0x86 
[DEBUG] {receiving [7 bytes]} 0xD5 0x87 0x00 0x00 0x00 0x90 0x00 
```

### 8) That's all ###

![http://ismb-snep-java.googlecode.com/files/50px-Done.png](http://ismb-snep-java.googlecode.com/files/50px-Done.png)


With this example you have used the ISMB-SNEP-LIBRARY to receive a message sent from an Android device, obviously modifying the android source code, you'll have the chance to send different messages.

---

## Steps to send data ##

### 1) Execute the app installed on the Android device "ISMB-SNEP" ###

... then wait until you'll see the following message:

![http://ismb-snep-java.googlecode.com/files/AndroidStartingSnepApp_site.jpg](http://ismb-snep-java.googlecode.com/files/AndroidStartingSnepApp_site.jpg)



### 2) Execute the java code "SenderToPhone" contained in the archive ###

http://ismb-snep-java.googlecode.com/files/ISMB-SNEP-Library.zip

.. then wait until you'll see the following message:

```
Get factory
Get terminals
Terminal name: ACS ACR122U 00 00
Available Commands: receive, send and quit
```


### 3) Write "send" and wait unit the following messages appear in the console ###
```
Get factory
Get terminals
Terminal name: ACS ACR122U-CCID 00 00
Available Commands: receive, send and quit
send
card: PC/SC card in ACS ACR122U-CCID 00 00, protocol T=0, state OK
Protocol:T=0
Called Procedure to Send data .. TARGET MODE
[DEBUG] {sending   [56 bytes]} 0xFF 0x00 0x00 0x00 0x33 0xD4 0x8C 0x00 0x00 0x00 0x00 0x00 0x00 0x40 0x01 0xFE 0x0F 0xBB 0xBA 0xA6 0xC9 0x89 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0xFF 0xFF 0x01 0xFE 0x0F 0xBB 0xBA 0xA6 0xC9 0x89 0x00 0x00 0x0F 0x46 0x66 0x6D 0x01 0x01 0x10 0x03 0x02 0x00 0x01 0x04 0x01 0x96 
```


### 4) Put the Android phone on the NFC reader ###

![http://ismb-snep-java.googlecode.com/files/PuttingAndroid_site.jpg](http://ismb-snep-java.googlecode.com/files/PuttingAndroid_site.jpg)


### 5) As soon as the phone will be on the NFC reader, the J2SE application will go on and the message will be sent to the Android device. ###
**Note** Do not touch anything on the Android device and keep your fingers crossed
![http://ismb-snep-java.googlecode.com/files/Crossed_Fingers_50px.jpg](http://ismb-snep-java.googlecode.com/files/Crossed_Fingers_50px.jpg)

### 6) On the J2SE console the following messages will appear ###
```
Get factory
Get terminals
Terminal name: ACS ACR122U-CCID 00 00
Available Commands: receive, send and quit
send
card: PC/SC card in ACS ACR122U-CCID 00 00, protocol T=0, state OK
Protocol:T=0
Called Procedure to Send data .. TARGET MODE
[DEBUG] {sending   [56 bytes]} 0xFF 0x00 0x00 0x00 0x33 0xD4 0x8C 0x00 0x00 0x00 0x00 0x00 0x00 0x40 0x01 0xFE 0x0F 0xBB 0xBA 0xA6 0xC9 0x89 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0xFF 0xFF 0x01 0xFE 0x0F 0xBB 0xBA 0xA6 0xC9 0x89 0x00 0x00 0x0F 0x46 0x66 0x6D 0x01 0x01 0x10 0x03 0x02 0x00 0x01 0x04 0x01 0x96 
[DEBUG] {receiving [35 bytes]} 0xD5 0x8D 0x25 0x1E 0xD4 0x00 0x4D 0x79 0x12 0xD7 0xBF 0x8B 0x17 0x23 0xE2 0x82 0x00 0x00 0x00 0x32 0x46 0x66 0x6D 0x01 0x01 0x11 0x03 0x02 0x00 0x13 0x04 0x01 0x96 0x90 0x00 
[DEBUG] {sending   [7 bytes]} 0xFF 0x00 0x00 0x00 0x02 0xD4 0x86 
[DEBUG] {receiving [7 bytes]} 0xD5 0x87 0x00 0x00 0x00 0x90 0x00 
[DEBUG] {sending   [9 bytes]} 0xFF 0x00 0x00 0x00 0x04 0xD4 0x8E 0x11 0x20 
[DEBUG] {receiving [5 bytes]} 0xD5 0x8F 0x00 0x90 0x00 
[DEBUG] {sending   [9 bytes]} 0xFF 0x00 0x00 0x00 0x04 0xD4 0x8E 0x00 0x00 
[DEBUG] {receiving [5 bytes]} 0xD5 0x8F 0x00 0x90 0x00 
[DEBUG] {sending   [7 bytes]} 0xFF 0x00 0x00 0x00 0x02 0xD4 0x86 
[DEBUG] {receiving [7 bytes]} 0xD5 0x87 0x00 0x81 0x84 0x90 0x00 
[DEBUG] {sending   [104 bytes]} 0xFF 0x00 0x00 0x00 0x63 0xD4 0x8E 0x13 0x20 0x00 0x10 0x02 0x00 0x00 0x00 0x58 0xD2 0x24 0x31 0x61 0x70 0x70 0x6C 0x69 0x63 0x61 0x74 0x69 0x6F 0x6E 0x2F 0x63 0x6F 0x6D 0x2E 0x65 0x78 0x61 0x6D 0x70 0x6C 0x65 0x2E 0x61 0x6E 0x64 0x72 0x6F 0x69 0x64 0x2E 0x62 0x65 0x61 0x6D 0x42 0x65 0x61 0x6D 0x20 0x72 0x65 0x63 0x65 0x69 0x76 0x65 0x64 0x20 0x66 0x72 0x6F 0x6D 0x20 0x49 0x53 0x4D 0x42 0x20 0x53 0x4E 0x45 0x50 0x20 0x4C 0x49 0x42 0x52 0x41 0x52 0x59 0x3A 0x0A 0x0A 0x67 0x6F 0x6F 0x64 0x20 0x6C 0x75 0x63 0x6B 0x21 
[DEBUG] {receiving [5 bytes]} 0xD5 0x8F 0x00 0x90 0x00 
[DEBUG] {sending   [7 bytes]} 0xFF 0x00 0x00 0x00 0x02 0xD4 0x86 
[DEBUG] {receiving [8 bytes]} 0xD5 0x87 0x00 0x83 0x44 0x01 0x90 0x00 
[DEBUG] {sending   [9 bytes]} 0xFF 0x00 0x00 0x00 0x04 0xD4 0x8E 0x11 0x60 
[DEBUG] {receiving [5 bytes]} 0xD5 0x8F 0x00 0x90 0x00 
[DEBUG] {sending   [7 bytes]} 0xFF 0x00 0x00 0x00 0x02 0xD4 0x86 
[DEBUG] {receiving [14 bytes]} 0xD5 0x87 0x00 0x83 0x04 0x01 0x10 0x81 0x00 0x00 0x00 0x00 0x90 0x00 
```

On the smartphone side (Android), instead, the message received will be displayed

![http://ismb-snep-java.googlecode.com/files/DataReceivedAndroid_site.jpg](http://ismb-snep-java.googlecode.com/files/DataReceivedAndroid_site.jpg)


### 7) That's all ###

![http://ismb-snep-java.googlecode.com/files/50px-Done.png](http://ismb-snep-java.googlecode.com/files/50px-Done.png)

With this example you have used the ISMB-SNEP-LIBRARY to send the following message to an Android device:

_Beam received from ISMB SNEP LIBRARY:_

_good luck!_


**Note** Obviously, modifying the library source code it is possible to send different NDEF messages both in terms of type and application.


---

Please consider these examples as Proof of Concepts and not as fully defined and bug free applications.


---

**If you're interested in contributing to build a stable library, please contact me at lotito@ismb.it**