# Introduction #


In this wiki page, the test environment will be presented together with the logical steps necessary to test the SNEP (Simple NDEF Push Protocol) library. In particular this wiki will show the communication flow from smartphone (Android LG Optimus L5- E610) to reader (Touchatag NFC reader).

See which SampleProjects are included in the source code..


# Details #


**Test Environment**

![http://ismb-snep-java.googlecode.com/files/TestEnvironmentAndroidSite_2.jpg](http://ismb-snep-java.googlecode.com/files/TestEnvironmentAndroidSite_2.jpg)



**Requirements**

- Java and an IDE (e.g. Eclipse)


- ACS ACR12U2 PC/SC Driver,
available at http://www.acs.com.hk/index.php?pid=product&id=ACR122U


- if you're using Eclipse, modify settings in order to use javax.smartcard
as shown in the page http://code.google.com/p/ismb-npp-java/wiki/EclipseSettings4javax


- Download and install the Android app available in the download section.


source: http://ismb-snep-java.googlecode.com/files/SNEP_PhoneToReader_Android_Client_SRC.zip

or

installer: http://ismb-snep-java.googlecode.com/files/SNEP_PhoneToReader_Android_Client_APK.zip


- Download the library source code available in the download section.

source:http://ismb-snep-java.googlecode.com/files/ISMB-SNEP-LIBRARY_PhoneToReader_Java_Client_SRC.zip



---



**Steps**

**1) Execute the app installed on the Android device (SnepPusher)**

... then wait until you'll see the following message:

![http://ismb-snep-java.googlecode.com/files/Android_Starting_SenderApp.jpg](http://ismb-snep-java.googlecode.com/files/Android_Starting_SenderApp.jpg)

**2) Execute the java code (PhoneToSender)** contained in the archive

http://ismb-snep-java.googlecode.com/files/ISMB-SNEP-LIBRARY_PhoneToReader_Java_Client_SRC.zip

... then wait until in the console appears the following messages:

```
Get factory
Get terminals
Terminal name: ACS ACR122U 00 00
card: PC/SC card in ACS ACR122U 00 00, protocol T=0, state OK
Protocol:T=0
Called Procedure to Receive data .. INITIATOR MODE
[DEBUG] {sending   [23 bytes]} 0xFF 0x00 0x00 0x00 0x12 0xD4 0x56 0x01 0x02 0x04 0x46 0x66 0x6D 0x01 0x01 0x10 0x03 0x02 0x00 0x01 0x04 0x01 0x96 
```


**3) Put the Android phone on NFC reader**

![http://ismb-snep-java.googlecode.com/files/Putting_Smartphone_On_site.jpg](http://ismb-snep-java.googlecode.com/files/Putting_Smartphone_On_site.jpg)


**4) As soon as the phone will be on the NFC reader, the J2SE application will go on printing always the same exchange**
```
Get factory
Get terminals
Terminal name: ACS ACR122U 00 00
card: PC/SC card in ACS ACR122U 00 00, protocol T=0, state OK
Protocol:T=0
Called Procedure to Receive data .. INITIATOR MODE
[DEBUG] {sending   [23 bytes]} 0xFF 0x00 0x00 0x00 0x12 0xD4 0x56 0x01 0x02 0x04 0x46 0x66 0x6D 0x01 0x01 0x10 0x03 0x02 0x00 0x01 0x04 0x01 0x96 
[DEBUG] {receiving [34 bytes]} 0xD5 0x57 0x00 0x01 0x61 0x6F 0xAF 0xCA 0x1B 0x4E 0xD6 0x3D 0x28 0xE4 0x00 0x00 0x00 0x0E 0x32 0x46 0x66 0x6D 0x01 0x01 0x10 0x03 0x02 0x00 0x01 0x04 0x01 0x96 0x90 0x00 
IN JUMP FOR DEP done..
[DEBUG] {sending   [10 bytes]} 0xFF 0x00 0x00 0x00 0x05 0xD4 0x40 0x01 0x00 0x00 
[DEBUG] {receiving [7 bytes]} 0xD5 0x41 0x00 0x00 0x00 0x90 0x00 
[DEBUG] {sending   [10 bytes]} 0xFF 0x00 0x00 0x00 0x05 0xD4 0x40 0x01 0x00 0x00 
[DEBUG] {receiving [7 bytes]} 0xD5 0x41 0x00 0x00 0x00 0x90 0x00 
[DEBUG] {sending   [10 bytes]} 0xFF 0x00 0x00 0x00 0x05 0xD4 0x40 0x01 0x00 0x00 
[DEBUG] {receiving [7 bytes]} 0xD5 0x41 0x00 0x00 0x00 0x90 0x00 
...
[DEBUG] {sending   [10 bytes]} 0xFF 0x00 0x00 0x00 0x05 0xD4 0x40 0x01 0x00 0x00 
[DEBUG] {receiving [7 bytes]} 0xD5 0x41 0x00 0x00 0x00 0x90 0x00 
```

**5)This exchange will continue until you'll touch the smartphone, enabling the push operation.**

![http://ismb-snep-java.googlecode.com/files/AndroidPushToSend.jpg](http://ismb-snep-java.googlecode.com/files/AndroidPushToSend.jpg)

**6a) When you'll touch the display, the message will be sent and, at the end, an acknowledge will be shown on the smartphone**

![http://ismb-snep-java.googlecode.com/files/Android_Ack_Message_Sent.jpg](http://ismb-snep-java.googlecode.com/files/Android_Ack_Message_Sent.jpg)


**6b) On the other side, the NFC reader will receive data so the output will change and you'll have the data sent logged both in hex and in ASCII string (Both NDEF TYPE and PAYLOAD)**

```
Get factory
Get terminals
Terminal name: ACS ACR122U 00 00
card: PC/SC card in ACS ACR122U 00 00, protocol T=0, state OK
Protocol:T=0
Called Procedure to Receive data .. INITIATOR MODE
[DEBUG] {sending   [23 bytes]} 0xFF 0x00 0x00 0x00 0x12 0xD4 0x56 0x01 0x02 0x04 0x46 0x66 0x6D 0x01 0x01 0x10 0x03 0x02 0x00 0x01 0x04 0x01 0x96 
[DEBUG] {receiving [34 bytes]} 0xD5 0x57 0x00 0x01 0x42 0x45 0x44 0x64 0x97 0x63 0x25 0xCD 0xDC 0x70 0x00 0x00 0x00 0x0E 0x32 0x46 0x66 0x6D 0x01 0x01 0x10 0x03 0x02 0x00 0x01 0x04 0x01 0x96 0x90 0x00 
IN JUMP FOR DEP done..
[DEBUG] {sending   [10 bytes]} 0xFF 0x00 0x00 0x00 0x05 0xD4 0x40 0x01 0x00 0x00 
[DEBUG] {receiving [7 bytes]} 0xD5 0x41 0x00 0x00 0x00 0x90 0x00 
[DEBUG] {sending   [10 bytes]} 0xFF 0x00 0x00 0x00 0x05 0xD4 0x40 0x01 0x00 0x00 
[DEBUG] {receiving [7 bytes]} 0xD5 0x41 0x00 0x00 0x00 0x90 0x00 
[DEBUG] {sending   [10 bytes]} 0xFF 0x00 0x00 0x00 0x05 0xD4 0x40 0x01 0x00 0x00 
[DEBUG] {receiving [7 bytes]} 0xD5 0x41 0x00 0x00 0x00 0x90 0x00 
[DEBUG] {sending   [10 bytes]} 0xFF 0x00 0x00 0x00 0x05 0xD4 0x40 0x01 0x00 0x00 
[DEBUG] {receiving [7 bytes]} 0xD5 0x41 0x00 0x11 0x20 0x90 0x00 
Connection Request Received
[DEBUG] {sending   [10 bytes]} 0xFF 0x00 0x00 0x00 0x05 0xD4 0x40 0x01 0x81 0x84 
[DEBUG] {receiving [7 bytes]} 0xD5 0x41 0x00 0x00 0x00 0x90 0x00 
[DEBUG] {sending   [10 bytes]} 0xFF 0x00 0x00 0x00 0x05 0xD4 0x40 0x01 0x00 0x00 
[DEBUG] {receiving [85 bytes]} 0xD5 0x41 0x00 0x13 0x20 0x00 0x10 0x02 0x00 0x00 0x00 0x47 0xD2 0x24 0x20 0x61 0x70 0x70 0x6C 0x69 0x63 0x61 0x74 0x69 0x6F 0x6E 0x2F 0x63 0x6F 0x6D 0x2E 0x65 0x78 0x61 0x6D 0x70 0x6C 0x65 0x2E 0x61 0x6E 0x64 0x72 0x6F 0x69 0x64 0x2E 0x62 0x65 0x61 0x6D 0x42 0x65 0x61 0x6D 0x20 0x6D 0x65 0x20 0x75 0x70 0x21 0x0A 0x0A 0x42 0x65 0x61 0x6D 0x20 0x54 0x69 0x6D 0x65 0x3A 0x20 0x31 0x36 0x3A 0x30 0x30 0x3A 0x35 0x39 0x90 0x00 

Something received: 
  application/com.example.android.beamBeam me up!

Beam Time: 16:00:59
[DEBUG] {sending   [17 bytes]} 0xFF 0x00 0x00 0x00 0x0C 0xD4 0x40 0x01 0x83 0x04 0x01 0x10 0x81 0x00 0x00 0x00 0x00 
[DEBUG] {receiving [8 bytes]} 0xD5 0x41 0x00 0x13 0x60 0x01 0x90 0x00 
Finished
[DEBUG] {sending   [8 bytes]} 0xFF 0x00 0x00 0x00 0x03 0xD4 0x52 0x01 
[DEBUG] {receiving [5 bytes]} 0xD5 0x53 0x00 0x90 0x00 
```


**7) That's all**

![http://ismb-snep-java.googlecode.com/files/50px-Done.png](http://ismb-snep-java.googlecode.com/files/50px-Done.png)


With this example you have used the ISMB-SNEP-LIBRARY to receive a message sent from an Android device, obviously modifying the android source code, you'll have the chance to send different messages.


**Please consider this as the first release of the application as a Proof of Concept and not as a fully defined and bug free application. Obviously, it's not yet STABLE.**



If you're interested in contributing to build a stable library, please contact me at **lotito@ismb.it**.